(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-alert-control-edit-control"],{1923:function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){return a}));var a={uniDatetimePicker:e("59f8").default,uniPopup:e("cdd3").default},o=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("v-uni-view",{staticClass:"pagehome"},[a("v-uni-view",{staticClass:"tp-box tp-box-sizing tp-flex tp-flex-col"},[a("v-uni-view",{staticClass:"tp-panel tp-flex tp-flex-col tp-mg-l-r-30"},[a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-l tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("策略名称")]),a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"text",placeholder:"请输入名称","placeholder-class":"tp-plc"},model:{value:t.formData.name,callback:function(i){t.$set(t.formData,"name",i)},expression:"formData.name"}})],1),a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-l tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("策略描述")]),a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"text",placeholder:"请输入策略描述","placeholder-class":"tp-plc"},model:{value:t.formData.describe,callback:function(i){t.$set(t.formData,"describe",i)},expression:"formData.describe"}})],1),a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-l tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("策略优先级")]),a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"number",placeholder:"请输入策略优先级","placeholder-class":"tp-plc"},model:{value:t.formData.sort,callback:function(i){t.$set(t.formData,"sort",i)},expression:"formData.sort"}})],1)],1),a("v-uni-view",{staticClass:"tp-txt tp-box-sizing tp-mg-30"},[t._v("触发条件"),a("v-uni-view",{staticClass:"add_btn",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toAddtrig.apply(void 0,arguments)}}},[t._v("+新增一行")])],1),t._l(t.trigList,(function(i,o){return a("v-uni-view",{key:o,staticClass:"tp-panel tp-flex tp-flex-col tp-mg-l-r-30",style:{background:0==o?"#fff":"#F6F8FA"}},[i.relationship?a("v-uni-view",{staticClass:"info_header"},[a("v-uni-view",{staticClass:"tp-circle tp-mg-l-r-20 tp-active",staticStyle:{"margin-left":"10rpx"}}),a("v-uni-view",{staticClass:"info_header_d"},[t._v(t._s(i.relationshipName))])],1):t._e(),0==o?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("设备条件类型")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectConditionType(i,"trig")}}},[i.conditionTypeName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.conditionTypeName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1):t._e(),1==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("请选择设备分组")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectEqpGroup(i,"trig")}}},[i.eqpGroupName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.eqpGroupName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1):t._e(),1==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("请选择设备")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectEqp(i,"trig")}}},[i.eqpName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.eqpName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1):t._e(),1==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("条件")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectCondition(i,"trig")}}},[i.conditionName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.conditionName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1):t._e(),1==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("符号")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectSymbol(i,"trig")}}},[i.symbolName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.symbolName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1):t._e(),1==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("数值")]),3==i.filedType?a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20 add_input",attrs:{type:"number",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:i.trigNum,callback:function(e){t.$set(i,"trigNum",e)},expression:"data.trigNum"}}):a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20 add_input",attrs:{type:"text'",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:i.trigNum,callback:function(e){t.$set(i,"trigNum",e)},expression:"data.trigNum"}})],1):t._e(),2==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("次数")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectCishu(i)}}},[i.cishuName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.cishuName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1):t._e(),2==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[0==i.cishu?a("v-uni-view",[t._v("日期")]):t._e(),0==i.cishu?a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c"},[a("uni-datetime-picker",{attrs:{type:"datetime"},model:{value:i.dateTime,callback:function(e){t.$set(i,"dateTime",e)},expression:"data.dateTime"}},[a("v-uni-view",{staticStyle:{"font-size":"26rpx",color:"#999","text-align":"right"}},[t._v(t._s(i.dateTime?i.dateTime:"请选择日期"))])],1),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1):t._e(),1==i.cishu?a("v-uni-view",[t._v("时间")]):t._e(),1==i.cishu?a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c"},[a("v-uni-picker",{attrs:{mode:"time",value:i.dateTime,start:"00:00",end:"23:59"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindTimeChange(i,e)}},model:{value:i.dateTime,callback:function(e){t.$set(i,"dateTime",e)},expression:"data.dateTime"}},[a("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(i.dateTime?i.dateTime:"请选择时间"))])],1),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1):t._e()],1):t._e(),0!=o?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",{staticClass:"del_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toDeltrig(i,o)}}},[a("img",{attrs:{src:e("4597"),alt:""}}),t._v("删除")])],1):t._e()],1)})),a("v-uni-view",{staticClass:"tp-txt tp-box-sizing tp-mg-30"},[t._v("执行命令"),a("v-uni-view",{staticClass:"add_btn",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toAddCon.apply(void 0,arguments)}}},[t._v("+新增一行")])],1),t._l(t.controlList,(function(i,o){return a("v-uni-view",{key:o,staticClass:"tp-panel tp-flex tp-flex-col tp-mg-l-r-30",style:{background:0==o?"#fff":"#F6F8FA",marginBottom:"15rpx"}},[i.relationship?a("v-uni-view",{staticClass:"info_header"},[a("v-uni-view",{staticClass:"tp-circle tp-mg-l-r-20 tp-active",staticStyle:{"margin-left":"10rpx"}}),a("v-uni-view",{staticClass:"info_header_d"},[t._v(t._s(i.relationshipName))])],1):t._e(),a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("请选择设备分组")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectEqpGroup(i,"con")}}},[i.eqpGroupName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.eqpGroupName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1),a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("请选择设备")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectEqp(i,"con")}}},[i.eqpName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.eqpName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1),a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("条件")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toSelectCondition(i,"con")}}},[i.conditionName?a("v-uni-text",{staticClass:"tp-mg-r-10"},[t._v(t._s(i.conditionName))]):t._e(),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1),a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",[t._v("数值")]),3==i.filedType?a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20 add_input",attrs:{type:"number",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:i.conNum,callback:function(e){t.$set(i,"conNum",e)},expression:"data.conNum"}}):a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20 add_input",attrs:{type:"text'",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:i.conNum,callback:function(e){t.$set(i,"conNum",e)},expression:"data.conNum"}})],1),0!=o?a("v-uni-view",{staticClass:"tp-ipt-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",{staticClass:"del_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toDelCon(i,o)}}},[a("img",{attrs:{src:e("4597"),alt:""}}),t._v("删除")])],1):t._e()],1)})),a("v-uni-view",{staticClass:"tp-txt tp-box-sizing tp-mg-30"}),a("v-uni-view",{staticClass:"tp-panel tp-flex tp-flex-col tp-mg-l-r-30"},[a("v-uni-view",{staticClass:"tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c tp-box-sizing tp-pd-t-b-25"},[a("v-uni-view",{staticStyle:{"font-weight":"bold"}},[t._v("策略状态")]),a("v-uni-view",{staticClass:"tp-flex-1 tp-flex tp-flex-row tp-flex-j-r tp-flex-a-c"},[a("v-uni-view",{staticClass:"switchBtn"},[a("v-uni-view",{staticClass:"on"},[1==t.switchOnTwo?a("v-uni-view",{staticClass:"onIcon",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.switchOnTwo=0,t.switchCloseTwo=1}}}):a("v-uni-view",{staticClass:"closeIcon",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.switchOnTwo=1,t.switchCloseTwo=0}}},[a("v-uni-view",{staticClass:"closeIconL"})],1),a("i",{staticStyle:{"font-style":"normal"}},[t._v("开")])],1),a("v-uni-view",{staticClass:"close"},[0==t.switchCloseTwo?a("v-uni-view",{staticClass:"closeIcon",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.switchCloseTwo=1,t.switchOnTwo=0}}},[a("v-uni-view",{staticClass:"closeIconL"})],1):a("v-uni-view",{staticClass:"onIcon",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.switchCloseTwo=0,t.switchOnTwo=1}}}),t._v("关")],1)],1)],1)],1)],1),a("v-uni-view",{staticClass:"tp-box-sizing tp-mg-l-r-30",staticStyle:{padding:"0"}},[a("v-uni-button",{staticClass:"tp-btn",class:{"vc-btn-disabled":t.disabled},staticStyle:{"margin-bottom":"118rpx"},attrs:{loading:t.loading},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.doUpdateSubmit.apply(void 0,arguments)}}},[t._v("保\n\t\t\t\t存")])],1),a("uni-popup",{ref:"conditionType",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.conditionTypeList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.comfirConditionType(i)}}},[t._v(t._s(i.label))])})),1)],1)],1),a("uni-popup",{ref:"eqpGroups",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.eqpGroupsList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toConfirmeqpGroup(i)}}},[t._v(t._s(i.device_group))])})),1)],1)],1),a("uni-popup",{ref:"eqpPopup",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.eqpList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.comfirEqp(i)}}},[t._v(t._s(i.name))])})),1)],1)],1),a("uni-popup",{ref:"conditionPopup",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.conditionList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmCondition(i)}}},[t._v(t._s(i.name))])})),1)],1)],1),a("uni-popup",{ref:"symbolPopup",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.symbolList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmSymbol(i)}}},[t._v(t._s(i.name))])})),1)],1)],1),a("uni-popup",{ref:"relationshipPopup",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.relationshipList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmrRelationship(i)}}},[t._v(t._s(i.name))])})),1)],1)],1),a("uni-popup",{ref:"cishuPopup",attrs:{type:"bottom"}},[a("v-uni-scroll-view",{style:{maxHeight:"700rpx",background:"#fff"},attrs:{"scroll-y":!0,"scroll-with-animation":"true"}},[a("v-uni-view",{staticClass:"selectlist"},t._l(t.cishuList,(function(i,e){return a("v-uni-view",{key:e,staticClass:"select_item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmrCishu(i)}}},[t._v(t._s(i.name))])})),1)],1)],1),a("uni-popup",{ref:"addtrigPopup",attrs:{type:"bottom",mask:!0,maskClick:!0}},[a("v-uni-view",{staticClass:"logInfo"},[a("v-uni-view",{staticClass:"info_title"},[t._v("新增触发条件"),a("img",{attrs:{src:e("104b"),alt:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.$refs.addtrigPopup.close()}}})]),a("v-uni-view",{staticClass:"info_header"},[a("v-uni-view",{staticClass:"tp-circle tp-mg-l-r-20 tp-active",staticStyle:{"margin-left":"10rpx"}}),a("v-uni-view",{staticClass:"info_header_d"},[t._v(t._s(t.addTrigForm.relationshipName))]),a("span",{staticClass:"info_header_t",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.relationship("trig")}}},[a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1)],1),1==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"info_list"},[a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectEqpGroupAdd("trig")}}},[a("v-uni-view",{staticClass:"value"},[t._v("请选择设备分组：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addTrigForm.eqpGroupName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectEqpAdd("trig")}}},[a("v-uni-view",{staticClass:"value"},[t._v("请选择设备：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addTrigForm.eqpName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectConditionAdd("trig")}}},[a("v-uni-view",{staticClass:"value"},[t._v("条件：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addTrigForm.conditionName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectSymbolAdd("trig")}}},[a("v-uni-view",{staticClass:"value"},[t._v("符号：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addTrigForm.symbolName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"value"},[t._v("数值：")]),3==t.addTrigForm.filedType?a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"number",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:t.addTrigForm.trigNum,callback:function(i){t.$set(t.addTrigForm,"trigNum",i)},expression:"addTrigForm.trigNum"}}):a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"text'",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:t.addTrigForm.trigNum,callback:function(i){t.$set(t.addTrigForm,"trigNum",i)},expression:"addTrigForm.trigNum"}})],1)],1):t._e(),2==t.trigList[0].conditionType?a("v-uni-view",{staticClass:"info_list"},[a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectCishuAdd()}}},[a("v-uni-view",{staticClass:"value"},[t._v("次数：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addTrigForm.cishuName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),0==t.addTrigForm.cishu?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"value"},[t._v("日期：")]),a("v-uni-view",{staticClass:"label"},[a("uni-datetime-picker",{attrs:{type:"datetime"},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t.changeLog.apply(void 0,arguments)}},model:{value:t.addTrigForm.dateTime,callback:function(i){t.$set(t.addTrigForm,"dateTime",i)},expression:"addTrigForm.dateTime"}})],1),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1):t._e(),1==t.addTrigForm.cishu?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"value"},[t._v("时间：")]),a("v-uni-view",{staticClass:"label"},[a("v-uni-picker",{attrs:{mode:"time",value:t.addTrigForm.dateTime,start:"00:00",end:"23:59"},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t.bindTimeChangeAdd(i)}}},[a("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.addTrigForm.dateTime?t.addTrigForm.dateTime:"请选择时间"))])],1)],1),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1):t._e()],1):t._e(),a("v-uni-view",{staticClass:"info_btn"},[a("v-uni-view",{staticClass:"btn_del",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.$refs.addtrigPopup.close()}}},[t._v("取消")]),a("v-uni-view",{staticClass:"btn_save",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.saveTrig()}}},[t._v("保存")])],1)],1)],1),a("uni-popup",{ref:"addConPopup",attrs:{type:"bottom",mask:!0,maskClick:!0}},[a("v-uni-view",{staticClass:"logInfo"},[a("v-uni-view",{staticClass:"info_title"},[t._v("新增执行命令"),a("img",{attrs:{src:e("104b"),alt:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.$refs.addConPopup.close()}}})]),a("v-uni-view",{staticClass:"info_list"},[a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectEqpGroupAdd("con")}}},[a("v-uni-view",{staticClass:"value"},[t._v("请选择设备分组：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addConForm.eqpGroupName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectEqpAdd("con")}}},[a("v-uni-view",{staticClass:"value"},[t._v("请选择设备：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addConForm.eqpName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toSelectConditionAdd("con")}}},[a("v-uni-view",{staticClass:"value"},[t._v("条件：")]),a("v-uni-view",{staticClass:"label"},[t._v(t._s(t.addConForm.conditionName))]),a("v-uni-view",{staticClass:"iconfont iconjiantou1"})],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"value"},[t._v("数值：")]),3==t.addConForm.filedType?a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"number",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:t.addConForm.conNum,callback:function(i){t.$set(t.addConForm,"conNum",i)},expression:"addConForm.conNum"}}):a("v-uni-input",{staticClass:"tp-flex-1 tp-mg-l-20",attrs:{type:"text'",placeholder:"请输入数值","placeholder-class":"tp-plc"},model:{value:t.addConForm.conNum,callback:function(i){t.$set(t.addConForm,"conNum",i)},expression:"addConForm.conNum"}})],1)],1),a("v-uni-view",{staticClass:"info_btn"},[a("v-uni-view",{staticClass:"btn_del",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.$refs.addConPopup.close()}}},[t._v("取消")]),a("v-uni-view",{staticClass:"btn_save",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.saveCon()}}},[t._v("保存")])],1)],1)],1),a("cys-toast",{ref:"toast",attrs:{msg:t.toast.msg,direction:t.row,location:"top"}})],2)],1)},n=[]},"6aab":function(t,i,e){"use strict";e.r(i);var a=e("e3d8"),o=e.n(a);for(var n in a)"default"!==n&&function(t){e.d(i,t,(function(){return a[t]}))}(n);i["default"]=o.a},9595:function(t,i,e){var a=e("24fb");i=a(!1),i.push([t.i,".info[data-v-aed44150]{font-size:%?20?%;font-family:Source Han Sans CN;font-weight:400;color:#999;line-height:%?46?%;margin-bottom:%?51?%}.remark[data-v-aed44150]{margin-top:%?47?%;font-size:%?26?%;font-family:Source Han Sans CN;font-weight:700;color:#434343}.switchBtn[data-v-aed44150]{display:flex;text-align:right;float:right;flex:1;justify-content:flex-end;height:%?99?%;line-height:%?99?%}.on[data-v-aed44150]{display:flex;margin-right:%?65?%}.onIcon[data-v-aed44150]{width:%?25?%;height:%?25?%;border:2px solid #a5a5a5;background:#fff;border-radius:%?25?%;margin-top:%?34?%;margin-right:%?10?%}.close[data-v-aed44150]{display:flex}.tp-mg-l-r-30[data-v-aed44150]{padding-left:%?30?%;padding-right:%?30?%}.closeIcon[data-v-aed44150]{width:%?25?%;height:%?25?%;border:2px solid #32bac0;background:#fff;\r\n\t/* padding: 10rpx; */border-radius:%?25?%;margin-top:%?34?%;margin-right:%?10?%}.closeIconL[data-v-aed44150]{width:%?15?%;height:%?15?%;background:#32bac0;border-radius:%?15?%;margin:%?5?%}.selectlist[data-v-aed44150]{width:100%;max-height:%?700?%;background-color:#fff}.select_item[data-v-aed44150]{padding:%?10?%;text-align:center;font-size:%?26?%;font-weight:700;color:#333;height:%?80?%;line-height:%?80?%;border-bottom:%?1?% solid #f2f2f3}.tp-box[data-v-aed44150]{width:100%;min-height:100vh\r\n\t/* background: #F8F8F8; */\r\n\t/* border-top: 1rpx solid #F6F6F6; */}.tp-panel[data-v-aed44150]{background:#fff;border-radius:%?10?%}.tp-ipt-item[data-v-aed44150]{border-bottom:%?1?% solid #f1f1f1}.tp-ipt-item>uni-view[data-v-aed44150]:first-child{font-size:%?26?%;color:#333;font-weight:500}.tp-ipt-item>uni-input[data-v-aed44150]{font-size:%?26?%}.tp-ipt-item>uni-view:last-child>uni-text[data-v-aed44150]:first-child{font-size:%?26?%;font-weight:500;color:#999}.tp-ipt-item>uni-view:last-child>uni-view[data-v-aed44150]:last-child{font-size:%?26?%;font-weight:500;color:#999}.tp-panel>.tp-ipt-item[data-v-aed44150]:last-child{border-bottom:none}.tp-txt[data-v-aed44150]{font-size:%?26?%;font-family:Source Han Sans CN;color:#434343;display:flex;justify-content:space-between;font-family:Source Han Sans CN;font-weight:700;padding-left:%?15?%}.add_btn[data-v-aed44150]{font-size:%?26?%;font-family:Source Han Sans CN;font-weight:500;color:#207af5}.tp-ipt-item-i>uni-view[data-v-aed44150]:first-child,\r\n.tp-ipt-item-i>uni-view[data-v-aed44150]:last-child{width:44%;height:%?56?%;border:1px solid #a4a4a4;border-radius:4px;background:#fff}.tp-ipt-item-i>uni-view[data-v-aed44150]:first-child{font-size:%?26?%;font-weight:700;color:#333}.tp-ipt-item-i>uni-view[data-v-aed44150]:nth-child(2){width:4%}.tp-ipt-item-i>uni-view:last-child>uni-input[data-v-aed44150]{width:100%;height:%?56?%;text-align:center}.tp-plc[data-v-aed44150]{font-size:%?26?%;font-weight:500;color:#999}.tp-plc-i[data-v-aed44150]{font-size:%?26?%;font-weight:700;color:#333}.tp-panel-textarea[data-v-aed44150]{border-radius:10px}.tp-panel-textarea>uni-view[data-v-aed44150]:first-child{font-size:%?26?%;font-weight:700;color:#666}.tp-panel-textarea>uni-view:last-child>uni-textarea[data-v-aed44150]{width:100%;height:%?290?%;border:1px solid #e8e8e8;border-radius:10px}.tp-btn[data-v-aed44150]{width:100%;height:%?86?%;line-height:%?86?%;background:#343436;\r\n\t/* box-shadow: 0rpx 8rpx 31rpx 1rpx rgba(147, 147, 147, 0.35); */border-radius:%?10?%;font-size:%?26?%;font-weight:700;color:#fff;background:#207af5;border-radius:%?10?%;margin-top:%?40?%}.vc-btn-disabled[data-v-aed44150]{background:#888}.logInfo[data-v-aed44150]{height:%?989?%;background:#fff;border-radius:%?20?% %?20?% 0 0}.info_title[data-v-aed44150]{height:%?100?%;border-bottom:%?1?% solid #e5e7e7;line-height:%?100?%;font-size:%?32?%;font-family:Source Han Sans CN;font-weight:700;color:#333;text-align:center}.info_title img[data-v-aed44150]{width:%?26?%;height:%?26?%;float:right;margin-right:%?46?%;margin-top:%?37?%}.info_header[data-v-aed44150]{width:%?690?%;height:%?120?%;background:#f6f8fa;border-radius:%?10?%;margin:0 auto;margin-top:%?24?%;line-height:%?120?%;display:flex;justify-content:space-between}.info_header_d[data-v-aed44150]{font-size:%?26?%;font-family:Source Han Sans CN;font-weight:400;color:#434343;flex:1}.info_header_t[data-v-aed44150]{font-size:%?26?%;font-family:Source Han Sans CN;font-weight:400;color:#434343;margin-right:%?28?%}.info_list[data-v-aed44150]{padding-top:%?23?%;margin:0 %?30?%}.info_list .item[data-v-aed44150]{height:%?100?%;border-bottom:1px solid #e5e7e7;display:flex;line-height:%?100?%}.info_list .item .value[data-v-aed44150]{font-size:%?28?%;font-family:Source Han Sans CN;font-weight:500;color:#434343;flex:1}.info_list .item .label[data-v-aed44150]{font-size:%?26?%;font-family:Source Han Sans CN;font-weight:400;color:#666}.info_btn[data-v-aed44150]{margin-top:%?71?%;text-align:center;display:flex;justify-content:center}.info_btn .btn_del[data-v-aed44150]{width:%?272?%;height:%?86?%;line-height:%?86?%;border:1px solid #207af5;border-radius:%?10?%;font-size:%?32?%;font-family:Source Han Sans CN;font-weight:500;color:#207af5}.info_btn .btn_save[data-v-aed44150]{width:%?272?%;height:%?86?%;background:#207af5;border-radius:10px;line-height:%?86?%;font-size:%?32?%;font-family:Source Han Sans CN;font-weight:500;color:#fff;margin-left:%?25?%}.add_input[data-v-aed44150]{\r\n\t\t/* margin-top: 25rpx;\r\n\t\t */height:%?100?%;line-height:%?100?%}.uni-date__x-input[data-v-aed44150]{text-align:right}.uni-date-x--border[data-v-aed44150]{border:none}[data-v-aed44150] .uni-icons{display:none!important}.input_num[data-v-aed44150]{margin-top:%?35?%;text-align:right}.tp-panel .info_header[data-v-aed44150]{width:100%!important;height:%?100?%!important;line-height:%?100?%!important}.del_btn[data-v-aed44150]{font-size:%?26?%!important;font-family:Source Han Sans CN!important;font-weight:500!important;color:#db2a2a!important;width:100%!important;text-align:center!important}.del_btn img[data-v-aed44150]{width:%?32?%!important;height:%?32?%!important;margin-right:%?7?%!important;vertical-align:text-bottom}",""]),t.exports=i},af0b:function(t,i,e){"use strict";e.r(i);var a=e("1923"),o=e("6aab");for(var n in o)"default"!==n&&function(t){e.d(i,t,(function(){return o[t]}))}(n);e("fbee");var s,r=e("f0c5"),d=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,"aed44150",null,!1,a["a"],s);i["default"]=d.exports},b529:function(t,i,e){var a=e("9595");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=e("4f06").default;o("7e3ee715",a,!0,{sourceMap:!1,shadowMode:!1})},e3d8:function(t,i,e){"use strict";e("4de4"),e("4160"),e("4e82"),e("a434"),e("d3b7"),e("159b"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a={data:function(){return{addType:"",addTrigForm:{eqpGroup:"",eqpGroupName:"",eqp:"",eqpName:"",condition:"",conditionName:"",filedType:"",symbol:"",symbolName:"",trigNum:"",relationship:"",relationshipName:"",cishu:0,cishuName:"单次",dateTime:""},addConForm:{eqpGroup:"",eqpGroupName:"",eqp:"",eqpName:"",condition:"",conditionName:"",filedType:"",conNum:"",relationship:"",relationshipName:""},trigList:[{conditionType:1,conditionTypeName:"设备条件类型",eqpGroup:"",eqpGroupName:"",eqp:"",eqpName:"",condition:"",conditionName:"",filedType:"",symbol:"",symbolName:"",trigNum:"",relationship:"",relationshipName:"",cishu:0,cishuName:"单次",dateTime:""}],controlList:[{eqpGroup:"",eqpGroupName:"",eqp:"",eqpName:"",condition:"",conditionName:"",filedType:"",conNum:""}],relationshipList:[{name:"且",id:"&&"},{name:"或",id:"||"}],conditionList:[],eqpGroupsList:[],conditionTypeList:[{label:"设备条件类型",value:1},{label:"时间条件类型",value:2}],symbolList:[{name:"大于",id:">"},{name:"小于",id:"<"},{name:"等于",id:"="},{name:"大于等于",id:"≥"},{name:"小于等于",id:"≤"}],switchOnTwo:0,switchCloseTwo:1,loading:!1,disabled:!1,eqpList:[],currentEqp:{},toast:{msg:""},formData:{describe:"",name:"",sort:100},currentTrigData:{},currentConData:{},cishuList:[{name:"单次",id:0},{name:"每天",id:1}]}},onShow:function(){},onLoad:function(t){this.editId=t.id,this.getInfo()},methods:{getInfo:function(){var t=this;uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/automation/details",{id:this.editId},"post").then((function(i){if(200==i.code){t.formData.name=i.data.name,t.formData.describe=i.data.describe,t.formData.sort=i.data.sort,"1"==i.data.status?(t.switchOnTwo=0,t.switchCloseTwo=1):(t.switchOnTwo=1,t.switchCloseTwo=0);var e=JSON.parse(i.data.config).rules,a=JSON.parse(i.data.config).apply,o=[],n=[];if(1==i.data.type)e.forEach((function(e,a){var n={conditionType:0==a?i.data.type:"",conditionTypeName:0==a?t.conditionTypeList.filter((function(t){return t.value==i.data.type}))[0].label:"",eqpGroup:e.asset_id,eqpGroupName:"",eqp:e.device_id,eqpName:"",condition:e.field,conditionName:"",filedType:"",symbol:e.condition,symbolName:"",trigNum:e.value,relationship:0!=a?e.operator:"",relationshipName:0!=a&&e.operator?t.relationshipList.filter((function(t){return t.id==e.operator}))[0].name:"",cishu:0,cishuName:"单次",dateTime:""};o.push(n)})),t.trigList=o,a.forEach((function(t,i){var e={eqpGroup:t.asset_id,eqpGroupName:"",eqp:t.device_id,eqpName:"",condition:t.field,conditionName:"",filedType:"",conNum:t.value};n.push(e)})),t.controlList=n,t.toSelectEqpGroup({},"edit"),t.trigList.forEach((function(i){t.toSelectEqp(i,"edit"),t.toSelectCondition(i,"edit"),t.symbolList.forEach((function(t){t.id==i.symbol&&(i.symbolName=t.name)}))})),t.controlList.forEach((function(i){t.toSelectEqp(i,"edit"),t.toSelectCondition(i,"edit"),t.symbolList.forEach((function(t){t.id==i.symbol&&(i.symbolName=t.name)}))}));else{e.forEach((function(e,a){var n;n={cishu:e.interval,cishuName:t.cishuList.filter((function(t){return t.id==e.interval}))[0].name,dateTime:e.time,relationship:0!=a?"":e.operator,relationshipName:0!=a?"":t.relationshipList.filter((function(t){return t.id==e.operator}))[0].name,conditionType:0==a?i.data.type:"",conditionTypeName:0==a?t.conditionTypeList.filter((function(t){return i.data.type==t.value}))[0].label:""},o.push(n)})),t.trigList=o;var s=JSON.parse(i.data.config).apply;n=[];s.forEach((function(t,i){var e={eqpGroup:"",eqpGroupName:"",eqp:"",eqpName:"",condition:"",conditionName:"",filedType:"",conNum:""};n.push(e)})),t.controlList=n}}else t.toast.msg=i.message,t.$refs.toast.show();uni.hideLoading()})).finally((function(){uni.hideLoading()}))},changeLog:function(t){console.log("change事件:",t)},bindTimeChangeAdd:function(t){console.log("change事件:",t),this.addTrigForm.dateTime=t.target.value},bindTimeChange:function(t,i){this.addType?this.addTrigForm.dateTime=i.target.value:this.type&&(t.dateTime=i.target.value)},validate:function(){var t=this.controlList.filter((function(t,i){return!t.eqpGroup||!t.eqp||!t.condition||!t.conNum}));if(""==this.formData.name)return this.toast.msg="请输入策略名称",this.$refs.toast.show(),!1;if(""==this.formData.describe)return this.toast.msg="请输入描述",this.$refs.toast.show(),!1;if(1==this.trigList[0].conditionType){var i=this.trigList.filter((function(t,i){return 0==i?!t.conditionType||!t.eqpGroup||!t.eqp||!t.condition||!t.symbol||!t.trigNum:!t.eqpGroup||!t.eqp||!t.condition||!t.symbol||!t.trigNum||!t.relationship}));if(i.length>0)return this.toast.msg="存在数据项不符合触发条件，请检查触发条件数据项",this.$refs.toast.show(),!1}else{var e=this.trigList.filter((function(t,i){return!t.cishuName||!t.dateTime}));if(e.length>0)return this.toast.msg="存在数据项不符合触发条件，请检查触发条件数据项",this.$refs.toast.show(),!1}return!(t.length>0)||(this.toast.msg="存在数据项不符合执行命令，请检查执行命令数据项",this.$refs.toast.show(),!1)},doUpdateSubmit:function(){var t=this;if(this.validate()){var i;0==this.switchOnOne?1:0,i=0==this.switchOnTwo?1:0,uni.showLoading({title:"加载中"});var e=[];1==this.trigList[0].conditionType?this.trigList.forEach((function(t){var i={asset_id:t.eqpGroup,device_id:t.eqp,field:t.condition,field_type:t.filedType,duration:"0",condition:t.symbol,value:t.trigNum,operator:t.relationship?t.relationship:""};e.push(i)})):this.trigList.forEach((function(t){var i={interval:t.cishu,time:t.dateTime,operator:t.relationship?t.relationship:""};e.push(i)}));var a=[];this.controlList.forEach((function(t){var i={asset_id:t.eqpGroup,device_id:t.eqp,field:t.condition,field_type:t.filedType,value:t.conNum,field_symbol:t.field_symbol};a.push(i)}));var o={business_id:uni.getStorageSync("ywId"),status:i,name:this.formData.name,sort:this.formData.sort,type:this.trigList[0].conditionType,describe:this.formData.describe,issued:"0",config:{rules:e,apply:a},id:this.editId};o.config=JSON.stringify(o.config),this.API.apiRequest("/api/automation/edit",o,"post").then((function(i){200==i.code?(t.toast.msg=i.message,t.$refs.toast.show(),uni.navigateBack(-1)):(t.toast.msg=i.message,t.$refs.toast.show()),uni.hideLoading()})).finally((function(){uni.hideLoading()}))}},toDeltrig:function(t,i){var e=this;this.trigList.forEach((function(t,a){a==i&&e.trigList.splice(i,1)}))},toDelCon:function(t,i){var e=this;this.controlList.forEach((function(t,a){a==i&&e.controlList.splice(i,1)}))},confirmrCishu:function(t){"trig"==this.addType?(this.addTrigForm.cishu=t.id,this.addTrigForm.cishuName=t.name,this.$refs.addtrigPopup.open()):"trig"==this.type&&(this.currentTrigData.cishu=t.id,this.currentTrigData.cishuName=t.name),this.$refs.cishuPopup.close()},toSelectCishuAdd:function(){this.addType="trig",this.type="",this.$refs.addtrigPopup.close(),this.$refs.cishuPopup.open()},toSelectCishu:function(t){this.type="trig",this.addType="",this.currentTrigData=t,this.$refs.cishuPopup.open()},confirmrRelationship:function(t){"trig"==this.addType?(this.addTrigForm.relationship=t.id,this.addTrigForm.relationshipName=t.name,this.$refs.addtrigPopup.open()):"con"==this.addType&&(this.addConForm.relationship=t.id,this.addConForm.relationshipName=t.name,this.$refs.addConPopup.open()),this.$refs.relationshipPopup.close()},relationship:function(t){this.addType=t,this.type="","con"==t?this.$refs.addConPopup.close():"trig"==t&&this.$refs.addtrigPopup.close(),this.$refs.relationshipPopup.open()},saveConValidate:function(){return this.addConForm.eqpGroup?this.addConForm.eqp?this.addConForm.condition?!!this.addConForm.conNum||(this.toast.msg="请输入数值",this.$refs.toast.show(),!1):(this.toast.msg="请选择条件",this.$refs.toast.show(),!1):(this.toast.msg="请选择设备",this.$refs.toast.show(),!1):(this.toast.msg="请选择设备分组",this.$refs.toast.show(),!1)},saveTrigValidate:function(){if(1==this.trigList[0].conditionType){if(!this.addTrigForm.relationship)return this.toast.msg="请选择条件为且还是或",this.$refs.toast.show(),!1;if(!this.addTrigForm.eqpGroup)return this.toast.msg="请选择设备分组",this.$refs.toast.show(),!1;if(!this.addTrigForm.eqp)return this.toast.msg="请选择设备",this.$refs.toast.show(),!1;if(!this.addTrigForm.condition)return this.toast.msg="请选择条件",this.$refs.toast.show(),!1;if(!this.addTrigForm.symbol)return this.toast.msg="请选择符号",this.$refs.toast.show(),!1;if(!this.addTrigForm.trigNum)return this.toast.msg="请输入数值",this.$refs.toast.show(),!1}else{if(!this.addTrigForm.relationship)return this.toast.msg="请选择条件为且还是或",this.$refs.toast.show(),!1;if(!this.addTrigForm.cishuName)return this.toast.msg="请选择次数",this.$refs.toast.show(),!1;if(!this.addTrigForm.dateTime)return this.toast.msg="请选择日期或时间",this.$refs.toast.show(),!1}return!0},saveTrig:function(){this.saveTrigValidate()&&(1==this.trigList[0].conditionType?this.trigList.push({eqpGroup:this.addTrigForm.eqpGroup,eqpGroupName:this.addTrigForm.eqpGroupName,eqp:this.addTrigForm.eqp,eqpName:this.addTrigForm.eqpName,condition:this.addTrigForm.condition,conditionName:this.addTrigForm.conditionName,filedType:this.addTrigForm.filedType,symbol:this.addTrigForm.symbol,symbolName:this.addTrigForm.symbolName,trigNum:this.addTrigForm.trigNum,relationship:this.addTrigForm.relationship,relationshipName:this.addTrigForm.relationshipName}):this.trigList.push({cishu:this.addTrigForm.cishu,cishuName:this.addTrigForm.cishuName,dateTime:this.addTrigForm.dateTime,relationship:this.addTrigForm.relationship,relationshipName:this.addTrigForm.relationshipName}),this.$refs.addtrigPopup.close()),this.$forceUpdate()},saveCon:function(){this.saveConValidate()&&(this.controlList.push({eqpGroup:this.addConForm.eqpGroup,eqpGroupName:this.addConForm.eqpGroupName,eqp:this.addConForm.eqp,eqpName:this.addConForm.eqpName,condition:this.addConForm.condition,conditionName:this.addConForm.conditionName,filedType:this.addConForm.filedType,conNum:this.addConForm.conNum}),this.$refs.addConPopup.close())},confirmSymbol:function(t){this.type?("trig"==this.type?(this.currentTrigData.symbol=t.id,this.currentTrigData.symbolName=t.name):"con"==this.type&&(this.currentConData.symbol=t.key,this.currentConData.symbolName=t.name),this.$refs.symbolPopup.close()):this.addType&&("trig"==this.addType?(this.addTrigForm.symbol=t.id,this.addTrigForm.symbolName=t.name,this.$refs.addtrigPopup.open()):"con"==this.addType&&(this.addConForm.symbol=t.key,this.addConForm.symbolName=t.name,this.$refs.addConPopup.open()),this.$refs.symbolPopup.close())},toSelectSymbolAdd:function(t){this.addType=t,this.type="","trig"==t?this.$refs.addtrigPopup.close():"con"==t&&this.$refs.addConPopup.close(),console.log("=="),this.$refs.symbolPopup.open()},toSelectSymbol:function(t,i){this.type=i,this.addType="","trig"==i?this.currentTrigData=t:"con"==i&&(this.currentConData=t),this.$refs.symbolPopup.open()},confirmCondition:function(t){this.type?"trig"==this.type?(this.currentTrigData.condition=t.key,this.currentTrigData.conditionName=t.name,this.currentTrigData.filedType=t.type,this.currentTrigData.field_symbol=t.symbol):"con"==this.type&&(this.currentConData.condition=t.key,this.currentConData.conditionName=t.name,this.currentConData.filedType=t.type,this.currentConData.field_symbol=t.symbol):this.addType&&("trig"==this.addType?(this.addTrigForm.condition=t.key,this.addTrigForm.conditionName=t.name,this.addTrigForm.filedType=t.type,this.addTrigForm.field_symbol=t.symbol,this.$refs.addtrigPopup.open()):"con"==this.addType&&(this.addConForm.condition=t.key,this.addConForm.conditionName=t.name,this.addConForm.filedType=t.type,this.addConForm.field_symbol=t.symbol,this.$refs.addConPopup.open())),this.$refs.conditionPopup.close()},toSelectConditionAdd:function(t){var i=this;if(this.addType=t,this.type="",1==this.trigList[0].conditionType)if("trig"==t){if(!this.addTrigForm.eqp)return this.toast.msg="请选择设备",void this.$refs.toast.show()}else if("con"==t&&!this.addConForm.eqp)return this.toast.msg="请选择设备",void this.$refs.toast.show();uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/automation/show",{bid:"trig"==t?this.addTrigForm.eqp:this.addConForm.eqp},"post").then((function(e){200===e.code&&(e.data&&e.data.length>0?(i.conditionList=e.data,"trig"==t?i.$refs.addtrigPopup.close():"con"==t&&i.$refs.addConPopup.close(),i.$refs.conditionPopup.open()):(i.toast.msg="暂无可选择数据",i.$refs.toast.show())),uni.hideLoading()})).finally((function(){uni.hideLoading()}))},toSelectCondition:function(t,i){var e=this;if(this.type=i,this.addType="",1==this.trigList[0].conditionType&&("trig"==i?this.currentTrigData=t:"con"==i&&(this.currentConData=t)),!t.eqp)return this.toast.msg="请选择设备",void this.$refs.toast.show();uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/automation/show",{bid:t.eqp},"post").then((function(t){200===t.code&&(t.data&&t.data.length>0?("edit"==i?t.data.forEach((function(t){e.trigList.forEach((function(i){t.key==i.condition&&(i.conditionName=t.name,i.filedType=t.type)})),e.controlList.forEach((function(i){t.key==i.condition&&(i.conditionName=t.name,i.filedType=t.type)}))})):e.$refs.conditionPopup.open(),e.conditionList=t.data):(e.toast.msg="暂无可选择数据",e.$refs.toast.show())),uni.hideLoading()})).finally((function(){uni.hideLoading()}))},comfirEqp:function(t){this.type?("trig"==this.type?(this.currentTrigData.eqp=t.device_id,this.currentTrigData.condition="",this.currentTrigData.conditionName="",this.currentTrigData.eqpName=t.name):"con"==this.type&&(this.currentConData.condition="",this.currentConData.conditionName="",this.currentConData.eqp=t.device_id,this.currentConData.eqpName=t.name),this.$refs.eqpPopup.close()):this.addType&&("trig"==this.addType?(this.addTrigForm.eqp=t.device_id,this.addTrigForm.eqpName=t.name,this.addTrigForm.condition="",this.addTrigForm.conditionName="",this.$refs.addtrigPopup.open()):"con"==this.addType&&(this.addConForm.eqp=t.device_id,this.addConForm.eqpName=t.name,this.addConForm.condition="",this.addConForm.conditionName="",this.$refs.addConPopup.open()),this.$refs.eqpPopup.close())},toSelectEqpAdd:function(t){var i=this;if(this.addType=t,1==this.trigList[0].conditionType)if("trig"==t){if(!this.addTrigForm.eqpGroup)return this.toast.msg="请选择设备分组",void this.$refs.toast.show()}else if("con"==t&&!this.addConForm.eqpGroup)return this.toast.msg="请选择设备分组",void this.$refs.toast.show();uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/kv/current/asset/a",{asset_id:"trig"==t?this.addTrigForm.eqpGroup:this.addConForm.eqpGroup},"post").then((function(e){200===e.code&&(e.data&&e.data.devices.length>0?(i.eqpList=e.data.devices,"trig"==t?i.$refs.addtrigPopup.close():"con"==t&&i.$refs.addConPopup.close(),i.$refs.eqpPopup.open()):(i.toast.msg="暂无可选择数据",i.$refs.toast.show())),uni.hideLoading()})).finally((function(){uni.hideLoading()}))},toSelectEqp:function(t,i){var e=this;this.type=i,this.addType="","trig"==i?this.currentTrigData=t:"con"==i&&(this.currentConData=t),uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/kv/current/asset/a",{asset_id:t.eqpGroup},"post").then((function(t){200===t.code&&(t.data&&t.data.devices.length>0?("edit"==i?t.data.devices.forEach((function(t){e.trigList.forEach((function(i){t.device_id==i.eqp&&(i.eqpName=t.name)})),e.controlList.forEach((function(i){t.device_id==i.eqp&&(i.eqpName=t.name)}))})):e.$refs.eqpPopup.open(),e.eqpList=t.data.devices):(e.toast.msg="暂无可选择数据",e.$refs.toast.show())),uni.hideLoading()})).finally((function(){uni.hideLoading()}))},toConfirmeqpGroup:function(t){this.type?("trig"==this.type?(this.currentTrigData.eqpGroup=t.id,this.currentTrigData.eqpGroupName=t.device_group,this.currentTrigData.eqp="",this.currentTrigData.eqpName="",this.currentTrigData.condition="",this.currentTrigData.conditionName=""):"con"==this.type&&(this.currentConData.eqpGroup=t.id,this.currentConData.eqpGroupName=t.device_group,this.currentConData.eqp="",this.currentConData.eqpName="",this.currentConData.condition="",this.currentConData.conditionName=""),this.$refs.eqpGroups.close()):this.addType&&("trig"==this.addType?(this.addTrigForm.eqp="",this.addTrigForm.eqpName="",this.addTrigForm.condition="",this.addTrigForm.conditionName="",this.addTrigForm.eqpGroup=t.id,this.addTrigForm.eqpGroupName=t.device_group,this.$refs.addtrigPopup.open()):"con"==this.addType&&(this.addConForm.eqp="",this.addConForm.eqpName="",this.addConForm.condition="",this.addConForm.conditionName="",this.addConForm.eqpGroup=t.id,this.addConForm.eqpGroupName=t.device_group,this.$refs.addConPopup.open()),this.$refs.eqpGroups.close())},toSelectEqpGroup:function(t,i){var e=this;this.type=i,this.addType="","trig"==i?this.currentTrigData=t:"con"==i&&(this.currentConData=t),uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/asset/list/d",{business_id:uni.getStorageSync("ywId")},"post").then((function(t){200===t.code&&(t.data&&t.data.length>0?("edit"==i?(e.trigList.forEach((function(i){t.data.forEach((function(t){t.id==i.eqpGroup&&(i.eqpGroupName=t.device_group)}))})),console.log("controlList==",e.controlList),e.controlList.forEach((function(i){t.data.forEach((function(t){t.id==i.eqpGroup&&(console.log("list==",i),i.eqpGroupName=t.device_group)}))}))):e.$refs.eqpGroups.open(),e.eqpGroupsList=t.data):(e.toast.msg="暂无可选择数据",e.$refs.toast.show())),uni.hideLoading()})).finally((function(){uni.hideLoading()}))},toSelectEqpGroupAdd:function(t){var i=this;this.addType=t,this.type="",uni.showLoading({title:"加载中"}),this.API.apiRequest("/api/asset/list/d",{business_id:uni.getStorageSync("ywId")},"post").then((function(e){200===e.code&&(e.data&&e.data.length>0?(i.eqpGroupsList=e.data,"trig"==t?i.$refs.addtrigPopup.close():"con"==t&&i.$refs.addConPopup.close(),i.$refs.eqpGroups.open()):(i.toast.msg="暂无可选择数据",i.$refs.toast.show())),uni.hideLoading()})).finally((function(){uni.hideLoading()}))},toSelectConditionType:function(t,i){this.type=i,this.addType="","trig"==i?this.currentTrigData=t:"con"==i&&(this.currentConData=t),this.currentTrigData=t,this.$refs.conditionType.open()},comfirConditionType:function(t){"trig"==this.type?(this.currentTrigData.conditionType=t.value,this.currentTrigData.conditionTypeName=t.label):"con"==this.type&&(this.currentConData.conditionType=t.value,this.currentConData.conditionTypeName=t.label),this.$refs.conditionType.close()},toAddCon:function(){this.$refs.addConPopup.open()},toAddtrig:function(){this.$refs.addtrigPopup.open()}}};i.default=a},fbee:function(t,i,e){"use strict";var a=e("b529"),o=e.n(a);o.a}}]);