<view style="{{'height:'+(pageHeight)+';'+('background:'+('#f5f5f5')+';')}}" class="data-v-598c196e"><custom-nav style="padding-top:50rpx;" vue-id="5010d550-1" iconColor="#1B1B1B" pageTitle="设备详情" class="data-v-598c196e" bind:__l="__l"></custom-nav><view class="content data-v-598c196e" style="{{'margin-top:'+(marginTopHeight)+';'+('display:'+('inline-block')+';')+('width:'+('100%')+';')}}"><view class="device data-v-598c196e"><view class="device_img data-v-598c196e"><image src="/static/image/device_icon.png" mode class="data-v-598c196e"></image></view><view class="device_info data-v-598c196e"><view class="device_name data-v-598c196e"><label class="name _span data-v-598c196e">{{device_name}}</label><block wx:if="{{device_state==1}}"><label class="state green _span data-v-598c196e">• 在线</label></block><block wx:if="{{device_state==0}}"><label class="state _span data-v-598c196e">• 离线</label></block></view><view class="updatetime data-v-598c196e">更新时间:<block wx:if="{{latest_ts_name}}"><label class="_span data-v-598c196e">{{latest_ts_name}}</label></block></view></view></view><block wx:for="{{device.chartData}}" wx:for-item="chart" wx:for-index="index" wx:key="*this"><block wx:if="{{device.chartData&&device.chartData.length>0}}"><view class="jiance data-v-598c196e"><block wx:if="{{index==0}}"><view class="jiance_t data-v-598c196e">监测</view></block><view class="jiance_c data-v-598c196e"><view class="jiance_name data-v-598c196e">{{''+chart.name+''}}</view><canvas class="charts data-v-598c196e" canvas-id="{{'canvasLine'+index}}" id="{{'canvasLine'+index}}"></canvas></view></view></block></block><view class="control data-v-598c196e"><view class="control_t data-v-598c196e">控制</view><block wx:if="{{device.controlData&&device.controlData.length>0}}"><view class="control_l data-v-598c196e"><block wx:for="{{device.controlData}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block class="data-v-598c196e"><view class="control_l_item data-v-598c196e"><view class="control_l_item_l data-v-598c196e"><view class="iconfontImg data-v-598c196e"><block wx:if="{{item.state==0}}"><image src="/static/icon/device_close.png" class="data-v-598c196e"></image></block><block wx:if="{{item.state==1}}"><image src="/static/icon/device_on.png" class="data-v-598c196e"></image></block></view><view style="margin-left:24rpx;" class="data-v-598c196e"><view class="sp_item_title data-v-598c196e">{{item.typeName}}</view><block wx:if="{{item.state==0&&item.type=='switch'}}"><view class="sp_item_status data-v-598c196e">关闭</view></block><block wx:if="{{item.state==1&&item.type=='switch'}}"><view class="sp_item_status data-v-598c196e">开启</view></block></view></view><block wx:if="{{item.type=='switch'}}"><view class="control_l_item_r data-v-598c196e"><view data-event-opts="{{[['tap',[['changSwitch',['$0',index],[[['device.controlData','',index]]]]]]]}}" class="control_l_item_r_switch data-v-598c196e" bindtap="__e"><block wx:if="{{item.state==1}}"><image src="/static/icon/switch_on.png" class="data-v-598c196e"></image></block><block wx:if="{{item.state==0}}"><image src="/static/icon/switch_close.png" class="data-v-598c196e"></image></block></view></view></block><block wx:else><view class="send data-v-598c196e"><input class="sendNum data-v-598c196e" type="text" data-event-opts="{{[['input',[['__set_model',['$0','num','$event',[]],[[['device.controlData','',index]]]]]]]}}" value="{{item.num}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['toSendNum',['$0'],[[['device.controlData','',index]]]]]]]}}" bindtap="__e" class="data-v-598c196e">下发</button></view></block></view></block></block></view></block></view><block wx:if="{{warningData&&warningData.length>0}}"><view class="warning data-v-598c196e"><view class="warning_t data-v-598c196e">告警</view><block wx:for="{{warningData}}" wx:for-item="warn" wx:for-index="index" wx:key="index"><view class="warning_c data-v-598c196e"><view class="warning_c_l data-v-598c196e"><view class="warning_c_l_i data-v-598c196e"><view class="warning_c_l_i_t data-v-598c196e">{{''+warn.describe+''}}</view></view></view></view></block></view></block><view class="history data-v-598c196e"><view class="tp-title tp-mg-t-25 data-v-598c196e" style="margin-top:35rpx;margin-left:55rpx;margin-bottom:10rpx;">日志</view><block class="data-v-598c196e"><view class="tp-log tp-flex tp-flex-col tp-mg-t-15 data-v-598c196e"><block wx:for="{{logData}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['logInfo',['$0',index],[[['logData','',index]]]]]]]}}" class="tp-panel tp-flex tp-flex-col tp-box-sizing tp-pd-20 data-v-598c196e" bindtap="__e"><view class="tp-log-item tp-flex tp-flex-row tp-flex-j-s tp-flex-a-c data-v-598c196e"><view class="tp-time data-v-598c196e">{{item.cteate_time}}</view><view class="{{['tp-circle','tp-mg-l-r-20','data-v-598c196e',index==currentIndex?'tp-active':'']}}" style="margin-left:10rpx;"></view><view class="tp-flex-1 data-v-598c196e">{{item.remark}}</view><block wx:if="{{index==currentIndex}}"><view class="data-v-598c196e"><image src="../../static/icon/log_icon_on.png" class="data-v-598c196e"></image></view></block><block wx:else><view class="data-v-598c196e"><image src="../../static/icon/log_icon.png" class="data-v-598c196e"></image></view></block></view></view></block></view></block></view></view><uni-popup vue-id="5010d550-2" type="bottom" mask="{{true}}" maskClick="{{true}}" data-ref="logoPopup" class="data-v-598c196e vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><view class="logInfo data-v-598c196e"><view class="info_title data-v-598c196e">日志详情<image src="../../static/icon/close.png" alt data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" bindtap="__e" class="data-v-598c196e"></image></view><view class="info_header data-v-598c196e"><view class="tp-circle tp-mg-l-r-20 tp-active data-v-598c196e" style="margin-left:10rpx;"></view><view class="info_header_d data-v-598c196e">{{''+currentLog.remark+''}}</view><label class="info_header_t _span data-v-598c196e">{{currentLog.cteate_time}}</label></view><view class="info_list data-v-598c196e"><view class="item data-v-598c196e"><view class="value data-v-598c196e">设备名称：</view><view class="label data-v-598c196e">{{''+currentLog.device_name+''}}</view></view><view class="item data-v-598c196e"><view class="value data-v-598c196e">设备分组名称：</view><view class="label data-v-598c196e">{{''+currentLog.asset_name+">"+currentLog.device_name+''}}</view></view><view class="item data-v-598c196e"><view class="value data-v-598c196e">业务名称：</view><view class="label data-v-598c196e">{{''+currentLog.business_name+''}}</view></view><view class="item data-v-598c196e"><view class="value data-v-598c196e">操作类型：</view><block wx:if="{{currentLog.operation_type=='1'}}"><view class="label data-v-598c196e">定时触发</view></block><block wx:if="{{currentLog.operation_type=='2'}}"><view class="label data-v-598c196e">手动控制</view></block></view><view class="item data-v-598c196e"><view class="value data-v-598c196e">指令：</view><view class="label data-v-598c196e">{{''+currentLog.instruct+''}}</view></view><view class="item data-v-598c196e"><view class="value data-v-598c196e">发送结果：</view><block wx:if="{{currentLog.send_result=='1'}}"><view class="label data-v-598c196e">成功</view></block><block wx:if="{{currentLog.send_result=='2'}}"><view class="label data-v-598c196e">失败</view></block></view></view></view></uni-popup></view>